% All data are saved as [RC;Add-On]
% Expection only Naive as [RC;EL]
%% Naive
load('Data\Naive_99_9\Naive_AR_V_99_9.mat')
load('Data\Naive_99_9\Naive_SG_V_99_9.mat')
load('Data\Naive_99_9\Naive_AR_t_99_9.mat')
load('Data\Naive_99_9\Naive_SG_t_99_9.mat')

%% Load HP t-Student 99.9% Data
load('Data\HP_t_99_9\k_AR_t_HP_99_9.mat') % k fix, LGD simulated
load('Data\HP_t_99_9\LGD_AR_t_HP_99_9.mat') % k simulated, LGD fix
load('Data\HP_t_99_9\ind_AR_t_HP_99_9.mat')
load('Data\HP_t_99_9\corr_AR_t_HP_99_9.mat')

load('Data\HP_t_99_9\k_SG_t_HP_99_9.mat')
load('Data\HP_t_99_9\LGD_SG_t_HP_99_9.mat')
load('Data\HP_t_99_9\ind_SG_t_HP_99_9.mat')
load('Data\HP_t_99_9\corr_SG_t_HP_99_9.mat')

%% Load HP Vasicek 99.9% Data
load('Data\HP_V_99_9\k_AR_V_HP_99_9.mat')
load('Data\HP_V_99_9\LGD_AR_V_HP_99_9.mat')
load('Data\HP_V_99_9\ind_AR_V_HP_99_9.mat')
load('Data\HP_V_99_9\corr_AR_V_HP_99_9.mat')

load('Data\HP_V_99_9\k_SG_V_HP_99_9.mat')
load('Data\HP_V_99_9\LGD_SG_V_HP_99_9.mat')
load('Data\HP_V_99_9\ind_SG_V_HP_99_9.mat')
load('Data\HP_V_99_9\corr_SG_V_HP_99_9.mat')

%% Load LHP t-Student 99.9% Data
load('Data\LHP_t_99_9\k_AR_t_LHP_99_9.mat')
load('Data\LHP_t_99_9\LGD_AR_t_LHP_99_9.mat')
load('Data\LHP_t_99_9\ind_AR_t_LHP_99_9.mat')
load('Data\LHP_t_99_9\corr_AR_t_LHP_99_9.mat')

load('Data\LHP_t_99_9\k_SG_t_LHP_99_9.mat')
load('Data\LHP_t_99_9\LGD_SG_t_LHP_99_9.mat')
load('Data\LHP_t_99_9\ind_SG_t_LHP_99_9.mat')
load('Data\LHP_t_99_9\corr_SG_t_LHP_99_9.mat')

%% Load LHP Vasicek 99.9% Data
load('Data\LHP_V_99_9\k_AR_V_LHP_99_9.mat')
load('Data\LHP_V_99_9\LGD_AR_V_LHP_99_9.mat')
load('Data\LHP_V_99_9\ind_AR_V_LHP_99_9.mat')
load('Data\LHP_V_99_9\corr_AR_V_LHP_99_9.mat')

load('Data\LHP_V_99_9\k_SG_V_LHP_99_9.mat')
load('Data\LHP_V_99_9\LGD_SG_V_LHP_99_9.mat')
load('Data\LHP_V_99_9\ind_SG_V_LHP_99_9.mat')
load('Data\LHP_V_99_9\corr_SG_V_LHP_99_9.mat')

%% for 99%
%% Load HP t-Student 99% Data
load('Data\HP_t_99\k_AR_t_HP_99.mat') % k fix, LGD simulated
load('Data\HP_t_99\LGD_AR_t_HP_99.mat') % k simulated, LGD fix
load('Data\HP_t_99\ind_AR_t_HP_99.mat')
load('Data\HP_t_99\corr_AR_t_HP_99.mat')

load('Data\HP_t_99\k_SG_t_HP_99.mat')
load('Data\HP_t_99\LGD_SG_t_HP_99.mat')
load('Data\HP_t_99\ind_SG_t_HP_99.mat')
load('Data\HP_t_99\corr_SG_t_HP_99.mat')

%% Load HP Vasicek 99% Data
load('Data\HP_V_99\k_AR_V_HP_99.mat')
load('Data\HP_V_99\LGD_AR_V_HP_99.mat')
load('Data\HP_V_99\ind_AR_V_HP_99.mat')
load('Data\HP_V_99\corr_AR_V_HP_99.mat')

load('Data\HP_V_99\k_SG_V_HP_99.mat')
load('Data\HP_V_99\LGD_SG_V_HP_99.mat')
load('Data\HP_V_99\ind_SG_V_HP_99.mat')
load('Data\HP_V_99\corr_SG_V_HP_99.mat')

%% Load LHP t-Student 99% Data
load('Data\LHP_t_99\k_AR_t_LHP_99.mat')
load('Data\LHP_t_99\LGD_AR_t_LHP_99.mat')
load('Data\LHP_t_99\ind_AR_t_LHP_99.mat')
load('Data\LHP_t_99\corr_AR_t_LHP_99.mat')

load('Data\LHP_t_99\k_SG_t_LHP_99.mat')
load('Data\LHP_t_99\LGD_SG_t_LHP_99.mat')
load('Data\LHP_t_99\ind_SG_t_LHP_99.mat')
load('Data\LHP_t_99\corr_SG_t_LHP_99.mat')

%% Load LHP Vasicek 99% Data
load('Data\LHP_V_99\k_AR_V_LHP_99.mat')
load('Data\LHP_V_99\LGD_AR_V_LHP_99.mat')
load('Data\LHP_V_99\ind_AR_V_LHP_99.mat')
load('Data\LHP_V_99\corr_AR_V_LHP_99.mat')

load('Data\LHP_V_99\k_SG_V_LHP_99.mat')
load('Data\LHP_V_99\LGD_SG_V_LHP_99.mat')
load('Data\LHP_V_99\ind_SG_V_LHP_99.mat')
load('Data\LHP_V_99\corr_SG_V_LHP_99.mat')

%% Comparison LHP/HP Vasicek/t-Student k fix
figure()
plot([2:20], repmat(k_SG_V_LHP_99_9(2),19,1),'r')
hold on
plot([2:20], repmat(k_SG_V_HP_99_9(2),19,1),'m')
plot([2:20], k_SG_t_LHP_99_9(2,:),'b')
plot([2:20], k_SG_t_HP_99_9(2,:),'c')
% grid on
title('Comparison LHP/HP Vasicek/t-Student (SG)')
xlabel('Degree of Freedom')
ylabel('Add On')
legend('LHP Vasicek','HP Vasicek','LHP t-Student','HP t-Student','location','southeast')

figure()
plot([2:20], repmat(k_AR_V_LHP_99_9(2),19,1),'r')
hold on
plot([2:20], repmat(k_AR_V_HP_99_9(2),19,1),'m')
plot([2:20], k_AR_t_LHP_99_9(2,:),'b')
plot([2:20], k_AR_t_HP_99_9(2,:),'c')
% grid on
title('Comparison LHP/HP Vasicek/t-Student (AR)')
xlabel('Degree of Freedom')
ylabel('Add On')
legend('LHP Vasicek','HP Vasicek','LHP t-Student','HP t-Student','location','southeast')

%% Comparison LHP/HP Vasicek/t-Student LGD fix
figure()
plot([2:20], repmat(LGD_SG_V_LHP_99_9(2),19,1),'r')
hold on
plot([2:20], repmat(LGD_SG_V_HP_99_9(2),19,1),'m')
plot([2:20], LGD_SG_t_LHP_99_9(2,:),'b')
plot([2:20], LGD_SG_t_HP_99_9(2,:),'c')
% grid on
title('Comparison LHP/HP Vasicek/t-Student (SG)')
xlabel('Degree of Freedom')
ylabel('Add On')
legend('LHP Vasicek','HP Vasicek','LHP t-Student','HP t-Student','location','southeast')

figure()
plot([2:20], repmat(LGD_AR_V_LHP_99_9(2),19,1),'r')
hold on
plot([2:20], repmat(LGD_AR_V_HP_99_9(2),19,1),'m')
plot([2:20], LGD_AR_t_LHP_99_9(2,:),'b')
plot([2:20], LGD_AR_t_HP_99_9(2,:),'c')
% grid on
title('Comparison LHP/HP Vasicek/t-Student (AR)')
xlabel('Degree of Freedom')
ylabel('Add On')
legend('LHP Vasicek','HP Vasicek','LHP t-Student','HP t-Student','location','southeast')

%% Comparison LHP/HP Vasicek/t-Student ind
figure()
plot([2:20], repmat(ind_SG_V_LHP_99_9(2),19,1),'r')
hold on
plot([2:20], repmat(ind_SG_V_HP_99_9(2),19,1),'m')
plot([2:20], ind_SG_t_LHP_99_9(2,:),'b')
plot([2:20], ind_SG_t_HP_99_9(2,:),'c')
% grid on
title('Comparison LHP/HP Vasicek/t-Student (SG)')
xlabel('Degree of Freedom')
ylabel('Add On')
legend('LHP Vasicek','HP Vasicek','LHP t-Student','HP t-Student','location','southeast')

figure()
plot([2:20], repmat(ind_AR_V_LHP_99_9(2),19,1),'r')
hold on
plot([2:20], repmat(ind_AR_V_HP_99_9(2),19,1),'m')
plot([2:20], ind_AR_t_LHP_99_9(2,:),'b')
plot([2:20], ind_AR_t_HP_99_9(2,:),'c')
% grid on
title('Comparison LHP/HP Vasicek/t-Student (AR)')
xlabel('Degree of Freedom')
ylabel('Add On')
legend('LHP Vasicek','HP Vasicek','LHP t-Student','HP t-Student','location','southeast')

%% Comparison LHP/HP Vasicek/t-Student corr
figure()
plot([2:20], repmat(corr_SG_V_LHP_99_9(2),19,1),'r')
hold on
plot([2:20], repmat(corr_SG_V_HP_99_9(2),19,1),'m')
plot([2:20], corr_SG_t_LHP_99_9(2,:),'b')
plot([2:20], corr_SG_t_HP_99_9(2,:),'c')
% grid on
title('Comparison LHP/HP Vasicek/t-Student (SG)')
xlabel('Degree of Freedom')
ylabel('Add On')
legend('LHP Vasicek','HP Vasicek','LHP t-Student','HP t-Student')

figure()
plot([2:20], repmat(corr_AR_V_LHP_99_9(2),19,1),'r')
hold on
plot([2:20], repmat(corr_AR_V_HP_99_9(2),19,1),'m')
plot([2:20], corr_AR_t_LHP_99_9(2,:),'b')
plot([2:20], corr_AR_t_HP_99_9(2,:),'c')
% grid on
title('Comparison LHP/HP Vasicek/t-Student (AR)')
xlabel('Degree of Freedom')
ylabel('Add On')
legend('LHP Vasicek','HP Vasicek','LHP t-Student','HP t-Student')

%% Comparison Add-On in the four case LHP
% figure()
% plot([2:20], repmat(k_SG_V_LHP_99_9(2),19,1))
% hold on
% plot([2:20], repmat(LGD_SG_V_LHP_99_9(2),19,1))
% plot([2:20], repmat(ind_SG_V_LHP_99_9(2),19,1))
% plot([2:20], repmat(corr_SG_V_LHP_99_9(2),19,1))
% title('Comparison Add-On')
% xlabel(' ')
% ylabel('Add-on')
% legend('k fix','LGD fix','Ind','Corr')

figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
C = [k_SG_V_LHP_99_9(2) LGD_SG_V_LHP_99_9(2) ind_SG_V_LHP_99_9(2) corr_SG_V_LHP_99_9(2)]
bar(X,C)
hold on
title('Comparison Add-On')

%% Comparison different RC in the four case LHP
figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
y = [Naive_SG_V_99_9(1) k_SG_V_LHP_99_9(1)-Naive_SG_V_99_9(1)    ;...
     Naive_SG_V_99_9(1) LGD_SG_V_LHP_99_9(1)-Naive_SG_V_99_9(1)  ;...
     Naive_SG_V_99_9(1) ind_SG_V_LHP_99_9(1)-Naive_SG_V_99_9(1)  ;...
     Naive_SG_V_99_9(1) corr_SG_V_LHP_99_9(1)-Naive_SG_V_99_9(1)  ];
b=bar(X,y,'stacked');
hold on
xtips1 = b(1).XEndPoints;
ytips1 = b(1).YEndPoints;
labels1 = string(round(b(1).YData,2));
text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips2 = b(2).XEndPoints;
ytips2 = b(2).YEndPoints;
labels2 = string(round(b(2).YData,2));
text(xtips2,ytips2,labels2,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
title('Rappresentation of add-on effect on RC (SG)')
legend('Naive','Estimation Addition')

figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
y = [Naive_AR_V_99_9(1) k_AR_V_LHP_99_9(1)-Naive_AR_V_99_9(1)    ;...
     Naive_AR_V_99_9(1) LGD_AR_V_LHP_99_9(1)-Naive_AR_V_99_9(1)  ;...
     Naive_AR_V_99_9(1) ind_AR_V_LHP_99_9(1)-Naive_AR_V_99_9(1)  ;...
     Naive_AR_V_99_9(1) corr_AR_V_LHP_99_9(1)-Naive_AR_V_99_9(1)  ];
b=bar(X,y,'stacked');
hold on
xtips1 = b(1).XEndPoints;
ytips1 = b(1).YEndPoints;
labels1 = string(round(b(1).YData,2));
text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips2 = b(2).XEndPoints;
ytips2 = b(2).YEndPoints;
labels2 = string(round(b(2).YData,2));
text(xtips2,ytips2,labels2,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
title('Rappresentation of add-on effect on RC (AR)')
legend('Naive','Estimation Addition','location','north')

%% Comparison different RC in the four case LHP AND HP ON TOP
figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
y = [Naive_SG_V_99_9(1) k_SG_V_LHP_99_9(1)-Naive_SG_V_99_9(1)    k_SG_V_HP_99_9(1)-k_SG_V_LHP_99_9(1);...
     Naive_SG_V_99_9(1) LGD_SG_V_LHP_99_9(1)-Naive_SG_V_99_9(1)  LGD_SG_V_HP_99_9(1)-LGD_SG_V_LHP_99_9(1);...
     Naive_SG_V_99_9(1) ind_SG_V_LHP_99_9(1)-Naive_SG_V_99_9(1)  ind_SG_V_HP_99_9(1)-ind_SG_V_LHP_99_9(1);...
     Naive_SG_V_99_9(1) corr_SG_V_LHP_99_9(1)-Naive_SG_V_99_9(1) corr_SG_V_HP_99_9(1)-corr_SG_V_LHP_99_9(1) ];
bar(X,y,'stacked')
hold on
title('Rappresentation of add-on effect on RC')

%% Comparison RC for LHP and HP
figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
y = [k_SG_V_LHP_99_9(1) LGD_SG_V_LHP_99_9(1) ind_SG_V_LHP_99_9(1) corr_SG_V_LHP_99_9(1); ...
     k_SG_V_HP_99_9(1)  LGD_SG_V_HP_99_9(1)  ind_SG_V_HP_99_9(1)  corr_SG_V_HP_99_9(1)];
b = bar(X,y,'FaceColor','flat');
%b(1).CData(4,:) = [0 1 1];
hold on
title('Comparison RC in LHP and HP (SG)')
xtips1 = b(1).XEndPoints;
ytips1 = b(1).YEndPoints;
labels1 = string(round(b(1).YData,2));
text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips2 = b(2).XEndPoints;
ytips2 = b(2).YEndPoints;
labels2 = string(round(b(2).YData,2));
text(xtips2,ytips2,labels2,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
legend('LHP','HP')

figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
y = [k_AR_V_LHP_99_9(1) LGD_AR_V_LHP_99_9(1) ind_AR_V_LHP_99_9(1) corr_AR_V_LHP_99_9(1); ...
     k_AR_V_HP_99_9(1)  LGD_AR_V_HP_99_9(1)  ind_AR_V_HP_99_9(1)  corr_AR_V_HP_99_9(1)];
b = bar(X,y,'FaceColor','flat');
%b(1).CData(4,:) = [0 1 1];
hold on
title('Comparison RC in LHP and HP (AR)')
xtips1 = b(1).XEndPoints;
ytips1 = b(1).YEndPoints;
labels1 = string(round(b(1).YData,2));
text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips2 = b(2).XEndPoints;
ytips2 = b(2).YEndPoints;
labels2 = string(round(b(2).YData,2));
text(xtips2,ytips2,labels2,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
legend('LHP','HP','location','north')

%% Comparison RC for 99.9% and 99%
figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
y = [k_SG_V_LHP_99_9(1) LGD_SG_V_LHP_99_9(1) ind_SG_V_LHP_99_9(1) corr_SG_V_LHP_99_9(1); ...
     k_SG_V_LHP_99(1) LGD_SG_V_LHP_99(1) ind_SG_V_LHP_99(1) corr_SG_V_LHP_99(1)];
b = bar(X,y,'FaceColor','flat');
hold on
title('Comparison RC in 99.9% and 99% (SG)')
xtips1 = b(1).XEndPoints;
ytips1 = b(1).YEndPoints;
labels1 = string(round(b(1).YData,2));
text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips2 = b(2).XEndPoints;
ytips2 = b(2).YEndPoints;
labels2 = string(round(b(2).YData,2));
text(xtips2,ytips2,labels2,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
legend('LHP 99.9%','LHP 99%')

figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
y = [k_AR_V_LHP_99_9(1) LGD_AR_V_LHP_99_9(1) ind_AR_V_LHP_99_9(1) corr_AR_V_LHP_99_9(1); ...
     k_AR_V_LHP_99(1) LGD_AR_V_LHP_99(1) ind_AR_V_LHP_99(1) corr_AR_V_LHP_99(1)];
b = bar(X,y,'FaceColor','flat');
hold on
title('Comparison RC in 99.9% and 99% (AR)')
xtips1 = b(1).XEndPoints;
ytips1 = b(1).YEndPoints;
labels1 = string(round(b(1).YData,2));
text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips2 = b(2).XEndPoints;
ytips2 = b(2).YEndPoints;
labels2 = string(round(b(2).YData,2));
text(xtips2,ytips2,labels2,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
legend('LHP 99.9%','LHP 99%','location','north')

%% DOUBLE EFFECT - Comparison RC for 99.9% and 99%, LHP and HP
figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
y = [k_SG_V_LHP_99(1) LGD_SG_V_LHP_99(1) ind_SG_V_LHP_99(1) corr_SG_V_LHP_99(1); ...
     k_SG_V_LHP_99_9(1) LGD_SG_V_LHP_99_9(1) ind_SG_V_LHP_99_9(1) corr_SG_V_LHP_99_9(1); ...
     k_SG_V_HP_99_9(1) LGD_SG_V_HP_99_9(1) ind_SG_V_HP_99_9(1) corr_SG_V_HP_99_9(1); ...
     k_SG_V_HP_99(1) LGD_SG_V_HP_99(1) ind_SG_V_HP_99(1) corr_SG_V_HP_99(1)]';
b = bar(X,y,'FaceColor','flat');
hold on
title('Comparison RC in 99.9% and 99% (SG)')
xtips1 = b(1).XEndPoints;
ytips1 = b(1).YEndPoints;
labels1 = string(round(b(1).YData,2));
text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips2 = b(2).XEndPoints;
ytips2 = b(2).YEndPoints;
labels2 = string(round(b(2).YData,2));
text(xtips2,ytips2,labels2,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips3 = b(3).XEndPoints;
ytips3 = b(3).YEndPoints;
labels3 = string(round(b(3).YData,2));
text(xtips3,ytips3,labels3,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips4 = b(4).XEndPoints;
ytips4 = b(4).YEndPoints;
labels4 = string(round(b(4).YData,2));
text(xtips4,ytips4,labels4,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
legend('LHP 99%','LHP 99.9%','HP 99.9%','HP 99%')

figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
y = [k_AR_V_LHP_99(1) LGD_AR_V_LHP_99(1) ind_AR_V_LHP_99(1) corr_AR_V_LHP_99(1); ...
     k_AR_V_LHP_99_9(1) LGD_AR_V_LHP_99_9(1) ind_AR_V_LHP_99_9(1) corr_AR_V_LHP_99_9(1); ...
     k_AR_V_HP_99_9(1) LGD_AR_V_HP_99_9(1) ind_AR_V_HP_99_9(1) corr_AR_V_HP_99_9(1); ...
     k_AR_V_HP_99(1) LGD_AR_V_HP_99(1) ind_AR_V_HP_99(1) corr_AR_V_HP_99(1)]';
b = bar(X,y,'FaceColor','flat');
hold on
title('Comparison RC in 99.9% and 99% (AR)')
xtips1 = b(1).XEndPoints;
ytips1 = b(1).YEndPoints;
labels1 = string(round(b(1).YData,2));
text(xtips1,ytips1,labels1,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips2 = b(2).XEndPoints;
ytips2 = b(2).YEndPoints;
labels2 = string(round(b(2).YData,2));
text(xtips2,ytips2,labels2,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips3 = b(3).XEndPoints;
ytips3 = b(3).YEndPoints;
labels3 = string(round(b(3).YData,2));
text(xtips3,ytips3,labels3,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
xtips4 = b(4).XEndPoints;
ytips4 = b(4).YEndPoints;
labels4 = string(round(b(4).YData,2));
text(xtips4,ytips4,labels4,'HorizontalAlignment','center',...
    'VerticalAlignment','bottom')
% legend('LHP 99%','LHP 99.9%','HP 99.9%','HP 99%')

%% Comparison Add-On in the four case HP

figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
C = [k_SG_V_HP_99_9(2) LGD_SG_V_HP_99_9(2) ind_SG_V_HP_99_9(2) corr_SG_V_HP_99_9(2)]
bar(X,C)
hold on
title('Comparison Add-On HP (SG)')

figure()
X = categorical({'k fix','LGD fix','Ind','Corr'});
X = reordercats(X,{'k fix','LGD fix','Ind','Corr'});
C = [k_AR_V_HP_99_9(2) LGD_AR_V_HP_99_9(2) ind_AR_V_HP_99_9(2) corr_AR_V_HP_99_9(2)]
bar(X,C)
hold on
title('Comparison Add-On HP (AR)')

%% Distribution approximation LGD for different nu
% all nu
figure()
pep = fitdist(LGD,'Normal');
x_Graph = -5:0.01:5;
plot(x_Graph,std_LGD *normpdf(x_Graph)+LGD_hat)
hold on
for nu = 2:20
    LGD_Simulated=std_LGD *tpdf(x_Graph,nu)+LGD_hat;
    plot(x_Graph,LGD_Simulated,':')
    hold on
end
title('Comparison for all nu')
legend('Normal')

% extreme nu
figure()
plot(x_Graph,std_LGD *normpdf(x_Graph)+LGD_hat,'b')
hold on
nu = 2;
LGD_Simulated=std_LGD *tpdf(x_Graph,nu)+LGD_hat;
plot(x_Graph,LGD_Simulated,'--g')
hold on
nu = 20;
LGD_Simulated=std_LGD *tpdf(x_Graph,nu)+LGD_hat;
plot(x_Graph,LGD_Simulated,'--r')
legend('Normal','t-Student nu=2','t-Student nu=20')
title('Comparison for the extreme nu considered')
